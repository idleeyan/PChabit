<?xml version="1.0" encoding="UTF-8" ?>
<ContentDialog
    x:Class="Tai.App.Views.CategoryDetailDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    DefaultButton="Close"
    PrimaryButtonText="关闭"
    PrimaryButtonStyle="{StaticResource AccentButtonStyle}">
    
    <ContentDialog.Resources>
        <x:Double x:Key="ContentDialogMaxWidth">600</x:Double>
        <x:Double x:Key="ContentDialogMaxHeight">500</x:Double>
    </ContentDialog.Resources>
    
    <StackPanel Spacing="16" MinWidth="500">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            
            <Border
                Grid.Column="0"
                Width="48"
                Height="48"
                Margin="0,0,16,0"
                Background="{x:Bind ViewModel.CategoryColor, Mode=OneWay, Converter={StaticResource StringToBrushConverter}}"
                CornerRadius="8">
                <TextBlock
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    FontSize="24"
                    Text="{x:Bind ViewModel.CategoryIcon, Mode=OneWay}" />
            </Border>
            
            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                <TextBlock
                    FontSize="20"
                    FontWeight="SemiBold"
                    Text="{x:Bind ViewModel.CategoryName, Mode=OneWay}" />
                <TextBlock
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="{x:Bind ViewModel.CategoryDescription, Mode=OneWay}"
                    TextWrapping="Wrap" />
            </StackPanel>
        </Grid>
        
        <Border
            Height="1"
            Background="{ThemeResource DividerStrokeColorDefaultBrush}" />
        
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            
            <StackPanel Grid.Column="0" Spacing="4">
                <TextBlock
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="程序数量" />
                <TextBlock
                    FontSize="18"
                    FontWeight="SemiBold"
                    Text="{x:Bind ViewModel.ProgramCount, Mode=OneWay}" />
            </StackPanel>
            
            <StackPanel Grid.Column="1" Spacing="4">
                <TextBlock
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="创建时间" />
                <TextBlock
                    FontSize="14"
                    Text="{x:Bind ViewModel.CreatedAt, Mode=OneWay, Converter={StaticResource DateToStringConverter}}" />
            </StackPanel>
            
            <StackPanel Grid.Column="2" Spacing="4">
                <TextBlock
                    FontSize="12"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="更新时间" />
                <TextBlock
                    FontSize="14"
                    Text="{x:Bind ViewModel.UpdatedAt, Mode=OneWay, Converter={StaticResource DateToStringConverter}}" />
            </StackPanel>
        </Grid>
        
        <StackPanel
            Orientation="Horizontal"
            Spacing="8"
            Visibility="{x:Bind ViewModel.IsSystemCategory, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border
                Padding="6,2"
                Background="{ThemeResource SubtleFillColorSecondaryBrush}"
                CornerRadius="4">
                <TextBlock
                    FontSize="11"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                    Text="系统分类" />
            </Border>
        </StackPanel>
        
        <Border
            Height="1"
            Background="{ThemeResource DividerStrokeColorDefaultBrush}" />
        
        <StackPanel Spacing="8">
            <TextBlock
                FontSize="14"
                FontWeight="SemiBold"
                Text="已关联程序" />
            
            <ScrollViewer MaxHeight="200">
                <ListView
                    ItemsSource="{x:Bind ViewModel.ProgramMappings, Mode=OneWay}"
                    SelectionMode="None">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Border
                                Padding="12,8"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <FontIcon
                                        Grid.Column="0"
                                        Margin="0,0,12,0"
                                        VerticalAlignment="Center"
                                        FontSize="16"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Glyph="&#xECAA;" />
                                    
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock
                                            FontWeight="SemiBold"
                                            Text="{Binding ProcessAlias}"
                                            TextTrimming="CharacterEllipsis" />
                                        <TextBlock
                                            FontSize="11"
                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                            Text="{Binding ProcessName}"
                                            TextTrimming="CharacterEllipsis" />
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </ScrollViewer>
            
            <TextBlock
                FontSize="12"
                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                Text="暂无关联程序"
                Visibility="{x:Bind ViewModel.ProgramCount, Mode=OneWay, Converter={StaticResource InverseCountToVisibilityConverter}}" />
        </StackPanel>
    </StackPanel>
</ContentDialog>
