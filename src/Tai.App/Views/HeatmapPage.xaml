<Page
    x:Class="Tai.App.Views.HeatmapPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <ScrollViewer>
        <StackPanel Spacing="16" Padding="16">
            
            <TextBlock
                Style="{ThemeResource TitleTextBlockStyle}"
                Text="热力图" />

            <TextBlock
                Style="{ThemeResource SubtitleTextBlockStyle}"
                Text="本周概览" />
            
            <Grid ColumnSpacing="12" RowSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                
                <Border
                    Grid.Column="0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="总使用时间" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.WeeklyTotalUsage, Converter={StaticResource TimeSpanToReadableConverter}, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="1"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="按键次数" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.WeeklyTotalKeyPresses, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="2"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="鼠标点击" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.WeeklyTotalMouseClicks, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="3"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="平均活动强度" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.WeeklyAverageActivity, Converter={StaticResource DoubleToScoreConverter}, Mode=OneWay}" />
                    </StackPanel>
                </Border>
            </Grid>

            <Border
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="8">
                <StackPanel Padding="16" Spacing="12">
                    <Grid>
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="周热力图" />
                        <StackPanel
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            Spacing="8">
                            <Button
                                Command="{x:Bind ViewModel.PreviousWeekCommand}"
                                Content="&#xE76B;"
                                FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                Width="32"
                                Height="32"
                                Padding="0" />
                            <TextBlock
                                Text="{x:Bind ViewModel.WeekRangeText, Mode=OneWay}"
                                VerticalAlignment="Center"
                                Width="140"
                                TextAlignment="Center" />
                            <Button
                                Command="{x:Bind ViewModel.NextWeekCommand}"
                                Content="&#xE76C;"
                                FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                Width="32"
                                Height="32"
                                Padding="0" />
                            <ProgressRing
                                x:Name="WeeklyProgressRing"
                                Width="20"
                                Height="20"
                                IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}" />
                        </StackPanel>
                    </Grid>
                    
                    <Grid Margin="0,8,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        
                        <ItemsControl Grid.Row="0" HorizontalAlignment="Center">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="4" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.Items>
                                <TextBlock Text="一" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                                <TextBlock Text="二" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                                <TextBlock Text="三" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                                <TextBlock Text="四" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                                <TextBlock Text="五" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                                <TextBlock Text="六" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                                <TextBlock Text="日" Style="{ThemeResource CaptionTextBlockStyle}" Width="80" TextAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,8" />
                            </ItemsControl.Items>
                        </ItemsControl>
                        
                        <ItemsControl
                            Grid.Row="1"
                            ItemsSource="{x:Bind ViewModel.WeeklyHeatmapData, Mode=OneWay}"
                            HorizontalAlignment="Center">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="4" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border
                                        Background="{Binding ActivityScore, Converter={StaticResource ActivityToColorConverter}}"
                                        CornerRadius="4"
                                        Width="80"
                                        Height="80"
                                        Padding="8"
                                        ToolTipService.ToolTip="{Binding Date, Converter={StaticResource DateToDetailConverter}}">
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <TextBlock
                                                Text="{Binding Date.Day}"
                                                HorizontalAlignment="Center"
                                                FontSize="16"
                                                FontWeight="SemiBold"
                                                Foreground="{Binding ActivityScore, Converter={StaticResource ActivityToForegroundConverter}}" />
                                            <TextBlock
                                                Text="{Binding TotalUsage, Converter={StaticResource TimeSpanToReadableConverter}}"
                                                HorizontalAlignment="Center"
                                                FontSize="11"
                                                Margin="0,4,0,0"
                                                Foreground="{Binding ActivityScore, Converter={StaticResource ActivityToForegroundConverter}}" />
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Grid>
                    
                    <TextBlock
                        x:Name="WeeklyErrorMessageText"
                        Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                        Text="{x:Bind ViewModel.WeeklyErrorMessage, Mode=OneWay}"
                        TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <TextBlock
                Style="{ThemeResource SubtitleTextBlockStyle}"
                Text="本月概览"
                Margin="0,8,0,0" />
            
            <Grid ColumnSpacing="12" RowSpacing="12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                
                <Border
                    Grid.Column="0"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="总使用时间" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.MonthlyTotalUsage, Converter={StaticResource TimeSpanToReadableConverter}, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="1"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="按键次数" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.MonthlyTotalKeyPresses, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="2"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="鼠标点击" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.MonthlyTotalMouseClicks, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="3"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="活跃天数" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.MonthlyActiveDays, Mode=OneWay}" />
                    </StackPanel>
                </Border>
                
                <Border
                    Grid.Column="4"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                    <StackPanel Spacing="4">
                        <TextBlock
                            Style="{ThemeResource CaptionTextBlockStyle}"
                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                            Text="平均活动强度" />
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="{x:Bind ViewModel.MonthlyAverageActivity, Converter={StaticResource DoubleToScoreConverter}, Mode=OneWay}" />
                    </StackPanel>
                </Border>
            </Grid>

            <Border
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="8">
                <StackPanel Padding="16" Spacing="12">
                    <Grid>
                        <TextBlock
                            Style="{ThemeResource SubtitleTextBlockStyle}"
                            Text="月热力图" />
                        <StackPanel
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            Spacing="8">
                            <Button
                                Command="{x:Bind ViewModel.PreviousMonthCommand}"
                                Content="&#xE76B;"
                                FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                Width="32"
                                Height="32"
                                Padding="0" />
                            <TextBlock
                                Text="{x:Bind ViewModel.MonthRangeText, Mode=OneWay}"
                                VerticalAlignment="Center"
                                Width="100"
                                TextAlignment="Center" />
                            <Button
                                Command="{x:Bind ViewModel.NextMonthCommand}"
                                Content="&#xE76C;"
                                FontFamily="{ThemeResource SymbolThemeFontFamily}"
                                Width="32"
                                Height="32"
                                Padding="0" />
                            <ProgressRing
                                x:Name="MonthlyProgressRing"
                                Width="20"
                                Height="20"
                                IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}" />
                        </StackPanel>
                    </Grid>
                    
                    <Grid Margin="0,8,0,0" HorizontalAlignment="Left">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="44" />
                            <ColumnDefinition Width="44" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="一" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Grid.Column="1" Text="二" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Grid.Column="2" Text="三" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Grid.Column="3" Text="四" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Grid.Column="4" Text="五" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Grid.Column="5" Text="六" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Grid.Column="6" Text="日" Style="{ThemeResource CaptionTextBlockStyle}" HorizontalAlignment="Center" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,0,0,4" />
                    </Grid>
                    
                    <ItemsControl
                        ItemsSource="{x:Bind ViewModel.MonthlyHeatmapData, Mode=OneWay}"
                        HorizontalAlignment="Left">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid Orientation="Horizontal" MaximumRowsOrColumns="7" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border
                                    Background="{Binding ActivityScore, Converter={StaticResource ActivityToColorConverter}}"
                                    CornerRadius="4"
                                    Margin="1"
                                    Width="42"
                                    Height="42"
                                    ToolTipService.ToolTip="{Binding Date, Converter={StaticResource DateToDetailConverter}}">
                                    <TextBlock
                                        Text="{Binding Date.Day}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="12"
                                        Foreground="{Binding ActivityScore, Converter={StaticResource ActivityToForegroundConverter}}" />
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    
                    <TextBlock
                        x:Name="MonthlyErrorMessageText"
                        Foreground="{ThemeResource SystemFillColorCriticalBrush}"
                        Text="{x:Bind ViewModel.MonthlyErrorMessage, Mode=OneWay}"
                        TextWrapping="Wrap" />
                </StackPanel>
            </Border>

            <Border
                Background="{ThemeResource CardBackgroundFillColorSecondaryBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1"
                CornerRadius="8"
                Padding="16,16,16,24">
                <StackPanel Spacing="8">
                    <TextBlock
                        Style="{ThemeResource BodyStrongTextBlockStyle}"
                        Text="活动强度图例" />
                    <Grid ColumnSpacing="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <Border Grid.Column="0" Width="24" Height="24" Background="#1a1a2e" CornerRadius="4" />
                        <TextBlock Grid.Column="1" Text="低" VerticalAlignment="Center" Style="{ThemeResource CaptionTextBlockStyle}" />
                        <Border Grid.Column="2" Width="24" Height="24" Background="#16213e" CornerRadius="4" Margin="8,0,0,0" />
                        <Border Grid.Column="3" Width="24" Height="24" Background="#0f3460" CornerRadius="4" />
                        <Border Grid.Column="4" Width="24" Height="24" Background="#e94560" CornerRadius="4" />
                        <Border Grid.Column="5" Width="24" Height="24" Background="#ff6b6b" CornerRadius="4" />
                        <TextBlock Grid.Column="6" Text="高" VerticalAlignment="Center" Style="{ThemeResource CaptionTextBlockStyle}" />
                    </Grid>
                </StackPanel>
            </Border>

            <Border Height="32" />

        </StackPanel>
    </ScrollViewer>
</Page>
