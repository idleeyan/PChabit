<?xml version="1.0" encoding="UTF-8" ?>
<Page
    x:Class="Tai.App.Views.AnalyticsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModel="using:Tai.App.ViewModels"
    xmlns:local="using:Tai.App.Views"
    mc:Ignorable="d">
    
    <Grid>
        <Pivot>
            <PivotItem Header="周统计">
                <ScrollViewer Padding="24">
                    <StackPanel Spacing="24">
                        <TextBlock
                            FontSize="24"
                            FontWeight="SemiBold"
                            Text="数据分析" />
                        
                        <Grid ColumnSpacing="16" RowSpacing="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            
                            <Border
                                Grid.Column="0"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="4">
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Text="总活跃时间" />
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="SemiBold"
                                        Text="{x:Bind ViewModel.TotalActiveTime, Mode=OneWay}" />
                                </StackPanel>
                            </Border>
                            
                            <Border
                                Grid.Column="1"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="4">
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Text="日均时间" />
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="SemiBold"
                                        Text="{x:Bind ViewModel.AverageDailyTime, Mode=OneWay}" />
                                </StackPanel>
                            </Border>
                            
                            <Border
                                Grid.Column="2"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="4">
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Text="平均效率" />
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="SemiBold"
                                        Text="{x:Bind ViewModel.AverageProductivity, Mode=OneWay, Converter={StaticResource DoubleToScoreConverter}}" />
                                </StackPanel>
                            </Border>
                        </Grid>
                        
                        <Border
                            Padding="16"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="12">
                            <StackPanel Spacing="16">
                                <TextBlock
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    Text="每周活动统计" />
                                
                                <ItemsControl ItemsSource="{x:Bind ViewModel.WeeklyData, Mode=OneWay}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate x:DataType="viewModel:WeeklyDataItem">
                                            <Grid Margin="0,4">
                                                <TextBlock Text="{x:Bind Day}" Width="50" />
                                                <ProgressBar 
                                                    Margin="60,0,40,0" 
                                                    Maximum="12" 
                                                    Value="{x:Bind Hours}" />
                                                <TextBlock 
                                                    HorizontalAlignment="Right" 
                                                    Text="{x:Bind Hours, Converter={StaticResource HoursToStringConverter}}" />
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                        
                        <Grid ColumnSpacing="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            
                            <Border
                                Grid.Column="0"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="16">
                                    <TextBlock
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Text="趋势变化" />
                                    
                                    <ItemsControl ItemsSource="{x:Bind ViewModel.Trends, Mode=OneWay}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate x:DataType="viewModel:TrendItem">
                                                <Grid Margin="0,8">
                                                    <StackPanel Spacing="2">
                                                        <TextBlock FontWeight="Medium" Text="{x:Bind Name}" />
                                                        <TextBlock
                                                            FontSize="12"
                                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                            Text="{x:Bind Description}" />
                                                    </StackPanel>
                                                    <TextBlock
                                                        HorizontalAlignment="Right"
                                                        FontWeight="SemiBold"
                                                        Foreground="{x:Bind Direction, Converter={StaticResource TrendColorConverter}}"
                                                        Text="{x:Bind Change}" />
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                            
                            <Border
                                Grid.Column="1"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="16">
                                    <TextBlock
                                        FontSize="16"
                                        FontWeight="SemiBold"
                                        Text="行为模式" />
                                    
                                    <ItemsControl ItemsSource="{x:Bind ViewModel.Patterns, Mode=OneWay}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate x:DataType="viewModel:PatternItem">
                                                <Grid Margin="0,8">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="40" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <FontIcon
                                                        FontSize="20"
                                                        Foreground="{StaticResource PrimaryBrush}"
                                                        Glyph="{x:Bind Icon}" />
                                                    
                                                    <StackPanel Grid.Column="1" Spacing="2">
                                                        <TextBlock FontWeight="Medium" Text="{x:Bind Title}" />
                                                        <TextBlock
                                                            FontSize="12"
                                                            Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                            Text="{x:Bind Description}" />
                                                    </StackPanel>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </Grid>
                        
                        <Border
                            Padding="16"
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="12">
                            <StackPanel Spacing="16">
                                <TextBlock
                                    FontSize="16"
                                    FontWeight="SemiBold"
                                    Text="洞察建议" />
                                
                                <ItemsControl ItemsSource="{x:Bind ViewModel.Insights, Mode=OneWay}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate x:DataType="viewModel:InsightItem">
                                            <Border
                                                Margin="0,4"
                                                Padding="12"
                                                Background="{x:Bind Type, Converter={StaticResource InsightBackgroundConverter}}"
                                                CornerRadius="8">
                                                <StackPanel Spacing="4">
                                                    <TextBlock FontWeight="Medium" Text="{x:Bind Title}" />
                                                    <TextBlock
                                                        FontSize="12"
                                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                                        Text="{x:Bind Message}"
                                                        TextWrapping="Wrap" />
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                        
                        <Grid ColumnSpacing="16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            
                            <Border
                                Grid.Column="0"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="4">
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Text="总按键次数" />
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="SemiBold"
                                        Text="{x:Bind ViewModel.TotalKeyPresses, Mode=OneWay}" />
                                </StackPanel>
                            </Border>
                            
                            <Border
                                Grid.Column="1"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="4">
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Text="总鼠标点击" />
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="SemiBold"
                                        Text="{x:Bind ViewModel.TotalMouseClicks, Mode=OneWay}" />
                                </StackPanel>
                            </Border>
                            
                            <Border
                                Grid.Column="2"
                                Padding="16"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="12">
                                <StackPanel Spacing="4">
                                    <TextBlock
                                        FontSize="12"
                                        Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                        Text="访问网页数" />
                                    <TextBlock
                                        FontSize="20"
                                        FontWeight="SemiBold"
                                        Text="{x:Bind ViewModel.TotalWebPages, Mode=OneWay}" />
                                </StackPanel>
                            </Border>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </PivotItem>
            
            <PivotItem Header="应用流向">
                <local:SankeyView />
            </PivotItem>
        </Pivot>
    </Grid>
</Page>
